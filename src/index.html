<!DOCTYPE html>
<html lang="cmn">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
	<title>Best Wish</title>
</head>
<body>
<div></div>
<button>play</button>
<script>
	document.querySelector('button').addEventListener('click', (e)=>{
		fetch('/wish').then((res)=>{
			return res.text();
		}).then((text)=>{
			let sp = new SpeechSynthesisUtterance()
				, l = text.length
				, i = 0
				, div = document.querySelector('div')
			;

			sp.lang = 'zh-CN';
			sp.text = text;
			sp.rate = 1;

			let timer = setInterval(()=>{
				i++;
				div.innerText = text.slice(0, i);

				if( i === l ){
					clearInterval( timer );
				}
			}, 200);

			speechSynthesis.speak( sp );
		});
	});
</script>
</body>
</html>